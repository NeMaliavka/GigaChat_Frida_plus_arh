# templates.py

# Словарь с шаблонами ответов, переработанный для "живого" общения.
# Структура { "greeting": [], "body": "...", "follow_up": [] } используется 
# для гибкой сборки ответов в зависимости от контекста диалога.
TEMPLATES = {
    # --- 0. Системные и приветственные (остаются простыми) ---
    "start_greeting": [
        "Здравствуйте! Я Ноубаг, ваш персональный AI-ассистент. Готов ответить на ваши вопросы.",
        "Добрый день! Я Ноубаг, ваш виртуальный помощник. Чем могу быть полезен?"
    ],
    "привет/здравствуй/добрый день/здравствуйте/прив/приветствую": [
        "Здравствуйте! Я Ноубаг, AI-ассистент онлайн-школы программирования No Bugs. Чем могу вам помочь?",
        "Добрый день! Рад вас видеть. Я AI-помощник школы No Bugs. Готов ответить на ваши вопросы.",
    ],

    # --- 2. Информация о курсах (добавлена персонализация и живость) ---
    "про курсы/какие есть курсы/какие программы есть/что за курсы/ курсы школы/ курсы": {
        "greeting": None,
        "body": "Сейчас у нас два флагманских курса по Python: один для детей 10–13 лет (30 занятий) и второй, более интенсивный, для подростков 14–17 лет (20 занятий). Оба курса проходят онлайн, и мы с первого дня делаем упор на практику — создание настоящей игры.",
        "follow_up": ["Хотите, расскажу, в чем ключевое различие между программами?"]
    },
    "разница между курсами/чем отличаются курсы/отличие курсов/в чем отличия этих курсов/ разница курсов": {
        "greeting": ["Отличный вопрос, {parent_name}, здесь важно быть точным."],
        "body": "Программа и итоговый проект у них абсолютно одинаковые. Мы не усложняем курс для старших, а просто проходим его в более высоком темпе. С группой 10–13 лет мы идем не спеша, за 30 занятий, а с ребятами 14–17 лет — быстрее, за 20. Все зависит от скорости восприятия.",
        "follow_up": ["Как вы думаете, какой темп больше подойдет {child_name:datv}?"]
    },
    # --- ШАБЛОН ДЛЯ УНИКАЛЬНОСТИ КУРСА ---
    "чем особенен курс/что у вас особенного/в чем фишка/уникальность курса": {
        "greeting": None,
        "body": "Наша главная особенность — это фокус на создании **собственного проекта** с первого дня! Мы не просто изучаем команды, мы сразу применяем их для создания настоящей RPG-игры «Числолендия». Ребенок видит, как его код оживает, и это невероятно мотивирует.\n\n"
                "Второй ключевой момент — это **формат живых онлайн-занятий в мини-группах до 8 человек**. Это не лекция, а интерактивная мастерская, где преподаватель успевает уделить внимание каждому ученику и помочь разобраться со всеми сложностями.",
        "follow_up": ["Именно такой подход позволяет не просто выучить Python, а по-настоящему полюбить программирование. Хотите попробовать на бесплатном пробном уроке, как это работает?"]
    },
    
    # --- 3. Стоимость и скидки (добавлена эмпатия и четкость) ---
    "стоимость/цена/сколько стоит/стоимость занятий/прайс/расценки": {
        "greeting": ["Конечно, {parent_name}, давайте разберемся с ценами."],
        # ТЕЛО ОТВЕТА, КОГДА АКЦИЯ ДЕЙСТВУЕТ
        "body_promo_active": "У нас гибкая система. Сейчас действует акция для первых 100 учеников — 800 руб./урок. Также есть постоянные льготные условия для многодетных и неполных семей (650 руб./урок). Стандартная цена — 1000 рублей за занятие.",
        # ТЕЛО ОТВЕТА, КОГДА АКЦИЯ ЗАКОНЧИЛАСЬ
        "body_promo_ended": "У нас гибкая система. Акция для первых 100 учеников уже завершилась, но у нас по-прежнему действуют постоянные льготные условия для многодетных и неполных семей — 650 руб./урок. Стандартная цена — 1000 рублей за занятие.",
        "follow_up": ["Чтобы я мог рассчитать для вас самую выгодную цену, подскажите, пожалуйста, относится ли к вам какая-либо из льготных категорий?"]
    },

    "а мы входим в число первых 100/успеваем на акцию/еще есть скидка": {
        "greeting": None,
        "body_promo_active": "Да, на данный момент места по акции для первых 100 учеников еще есть! Но они быстро заканчиваются, поэтому лучше не откладывать.",
        "body_promo_ended": "К сожалению, набор по акции для первых 100 учеников уже завершен. Но я могу проверить, доступны ли вам другие льготные условия.",
        "follow_up": ["Хотите, я помогу вам оставить заявку, чтобы забронировать место?"]
    },

    "многодетная/одинокий родитель/есть ли льготы/многодетный/мать-одиночка/одинокая мама/отец-одиночка/одинокий отец/одна воспитывая/ один воспитываю": {
        "greeting": ["Да, конечно! Мы с радостью поддерживаем семьи."],
        "body": "Для многодетных родителей и родителей, воспитывающих детей в одиночку, у нас действует постоянная льготная цена — всего 650 рублей за занятие. Таким образом, полный курс будет стоить 13 000 (20 занятий) или 19 500 (30 занятий). Это отличные условия, чтобы дать ребенку качественные знания.",
        "follow_up": ["{parent_name}, хотите записаться на бесплатный пробный урок, чтобы познакомиться с нами поближе?"]
    },
    "почему такая стоимость/почему так дорого/почему так дешево/ почему такая цена": {
        "greeting": [
            "Понимаю вас, {parent_name}, вопрос цены — один из самых важных при выборе курсов.",
            "Хорошо, что вы об этом спросили. Давайте я объясню, из чего складывается наша стоимость."
        ],
        "body": "Наша цена отражает качество и индивидуальный подход. Занятия проходят в мини-группах до 8 человек, что позволяет преподавателю-практику из IT-сферы уделять внимание каждому ученику. Мы не просто даем теорию, а ведем каждого ребенка к созданию собственного, полноценного проекта. При этом наша стандартная цена в 1000 рублей за урок часто снижается до 650-800 рублей за счет акций и льгот, что делает образование доступнее.",
        "follow_up": ["Стало ли теперь понятнее, почему у нас именно такие цены?"]
    },

    # --- 4. Процесс обучения и результат (добавлены "живые" детали) ---
    "как проходят занятия/формат уроков/ онлайн/ оффлайн/ офлайн/ online/ ofline/ offline/ off-line": {
        "greeting": None,
        "body": "Все занятия проходят онлайн в живом формате, в Zoom или Jitsi. Мы собираемся в мини-группах до 8 человек, чтобы у преподавателя была возможность пообщаться с каждым, ответить на вопросы и помочь, если что-то не получается. Это не лекция, а скорее творческая мастерская, где мы вместе программируем, общаемся и делаем крутые проекты!",
        "follow_up": ['Вы сможете убедиться в удобстве онлайн урока на нашем пробном занятии, попробуем?']
    },
    "сертификат/будет ли сертификат/что в конце": {
        "greeting": None,
        "body": "Да, безусловно! В конце курса каждый ученик защищает свой финальный проект — текстовую RPG-игру — и получает именной сертификат от школы No Bugs. Это не просто красивая грамота, а первое весомое достижение в портфолио будущего программиста.",
        "follow_up": None
    },
    
    # --- 5. Запись на пробный урок (сделаны более убедительными) ---
    "как проходит пробный урок/что будет на пробном занятии/расскажите про пробник": {
        "greeting": None,
        "body": "Пробный урок — это наше с вами первое погружение в мир IT! Он проходит индивидуально с преподавателем и длится 30-40 минут. За это время {child_name} не просто напишет свой первый код, а, например, заставит персонажа в игре двигаться или отвечать на команды. Это тот самый момент, когда теория на глазах превращается в магию!",
        "follow_up": ["Это лучший способ понять наш подход без каких-либо обязательств. Подберем удобное время?"]
    },
    "записаться на пробный/хочу попробовать/бесплатный урок": {
        "greeting": ["Отличная идея, {parent_name}!", "Рад помочь с записью!"],
        "body": "Пробный урок — это лучший способ понять, подходит ли вам наш формат, и познакомиться с преподавателем.",
        "follow_up": ["Давайте подберем удобное время? Как насчет ближайших выходных или вечера в будни?"]
    },

    # --- 6. Завершение диалога (остаются простыми) ---
    "спасибо/благодарю": [
        "Пожалуйста! Рад был помочь.",
        "Не за что! Если появятся еще вопросы, обращайтесь.",
    ],
    "пока/до свидания": [
        "Всего доброго! Хорошего дня!",
        "До свидания! Будем рады видеть вас снова.",
    ],
}
